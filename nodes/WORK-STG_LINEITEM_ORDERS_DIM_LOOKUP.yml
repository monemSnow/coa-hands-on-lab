steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-ec08923b-cd65-4ca2-840d-dc28b936f12d:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: b55015fb-ec6a-4486-9000-cb2cba953292
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 254a176d-bd26-4a2a-85b6-ffc55979bdde
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: c20077b9-303f-4e9c-bebb-45fe45bec356
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cea8604a-ed9b-483e-9412-08a8c60bdb49
                    stepCounter: 0c5ef8a6-6c55-4aff-965b-0b636542e1e7
                transform: ""
          - columnReference:
              columnCounter: 3dd289e0-aea8-4281-bdfd-268bce33e10f
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d0351ea7-a3de-4860-8e5b-2de74a0a15ae
                    stepCounter: a4b433ba-6cae-4853-b882-16f5d2758c14
                transform: ""
          - columnReference:
              columnCounter: c153a533-a5ec-4178-ac12-932a1b18682b
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 30772698-d22f-4ce2-8018-93b7563256a9
                    stepCounter: c94612b2-0b99-40c6-b706-88da6388c9ad
                transform: ""
          - columnReference:
              columnCounter: 0952d8de-3c8d-4980-9a1a-d8f8414c610a
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e1607f7d-34d7-40ad-85e4-aecf4bb5023b
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: da83c253-4a44-411a-bf12-52dcd45ce962
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f8356b02-eeed-4d34-b3f6-1d82aa895c12
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 9ffe5190-5179-42a1-9c18-7f492ff06a34
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 55c680d0-0e6c-4389-8a71-6f1e085765c2
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 4e8c9395-8246-48a0-bdda-dff3d0817398
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6e1073ac-b7b0-488e-b251-b3639cc0541c
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 82f0c7f1-2db9-4fa7-8427-d8c634e0eecc
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1607be31-9b4e-48f5-8eb5-26716aedf5a9
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 1c9ae0dc-3ce1-4541-a466-18c4583840f6
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 08262d7e-be4a-4e1c-b843-ae609997c9f2
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 3043d9a8-34bf-4343-8579-ec1c264c6b6c
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9b917858-6568-4c0e-ae72-d97a5ae9c216
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: cf79a10e-9e39-46d2-8077-7f5400a709b3
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 897bfa4e-185a-4a6d-88d8-05e68fd6ab0d
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 014a0c9a-4687-42be-a6b9-9b657be29410
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3d375d10-c392-4b19-8af6-ebe67edbc547
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 5bf273bc-b9bc-45f4-861b-b636f398f3f6
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2210b305-dd79-4363-8360-bb5e1239e5a3
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: dca05713-04d9-495e-950e-9cd3191f2af5
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 717aee41-a52f-4691-b868-1e9640f25371
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: fe91f246-39c8-494e-b3c8-fdbb0acd0e4e
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 09f3930e-64b6-4624-a43c-34ef8f88edf9
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: f0968fba-7e4c-45ac-991d-4ff0d751a7ce
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c64ef672-abad-4459-92ea-36c13224c9a3
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 95f357bb-03ca-420e-9efb-f68f9da87e9b
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b047358a-2410-4241-a7fc-42b5b93a9e4c
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: ab1e5543-c8ac-4543-a70b-47623c59c738
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1219060c-d049-4157-9557-dddee04f08b8
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 2c1ae350-aa00-4821-9fa0-6a1e07605851
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2ea5cf8a-1c55-4df3-bac3-b4337844087a
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 06e39d58-c335-40b3-bd52-b5715590e5f3
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ed92487d-fc14-4f0a-8d2b-5d47514d894a
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 72cd4c4d-262f-4bb6-a8e8-7ebc6131e06d
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bd648629-b8c1-476f-9d47-e8a30e8ef4a8
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 0131709b-5ad8-48ee-8712-e458cb3363ad
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f9dc01ed-f656-422f-95f0-b965babe8c74
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 2354f35c-3cf1-402e-8bdf-dadef236f7f7
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1d358d04-5b35-4a96-80cd-794f55e1011e
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 0eb583dd-f411-4ccd-b1e2-a06495297a13
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 44831ac5-e4ff-4010-a969-01317bf4f191
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: acdef8b7-aca8-43f8-961d-ad0f13ab466e
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f547f280-ed9a-40cb-aa1e-231a9c554123
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: cf478839-341a-4497-815a-ff6a74f03be0
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 660b85da-d3e1-45c7-a47f-cf4c21fccdb8
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 71b46b74-45af-4900-99e3-b57a3ed23303
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4ff76f10-c7fb-4d27-b0c8-25bbc0be68a8
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 41afff50-6c10-4e3c-98ee-b71f6684bf29
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 12c5c18c-9fda-4ec6-84b8-73b2ae8068eb
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
          - columnReference:
              columnCounter: 62dd6744-79e2-4bdb-8b69-eff6103701fc
              stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 50239f88-4632-4978-8135-89aa89d4bbef
                    stepCounter: 380d6aed-89d0-4dd6-8643-911d098a8508
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 0c5ef8a6-6c55-4aff-965b-0b636542e1e7
              DIM_PART: a4b433ba-6cae-4853-b882-16f5d2758c14
              DIM_SUPPLIER: c94612b2-0b99-40c6-b706-88da6388c9ad
              STG_LINEITEM_ORDERS: 380d6aed-89d0-4dd6-8643-911d098a8508
              STG_PARTSUPP: c93dd6b8-199e-4964-a9a8-69307683ea73
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: ec08923b-cd65-4ca2-840d-dc28b936f12d
